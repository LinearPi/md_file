#Bayse(贝叶斯)

###贝叶斯基本公式: 

1. $P(X|Y)= \frac{P(Y|X)*P(X)}{P(Y)}$

2. $P(X,Y)=P(X|Y)P(Y)=P(Y|X)P(X)$

  P(X,Y)：联合概率
  P(X|Y)：后验概率
  P(Y|X)：先验概率
  P(X)：X条件概率（或边缘概率）

  P(Y)：Y条件概率（或边缘概率）

####$P(属于某类|具有某特征) = \frac{P(具有某特征|属于某类)*P(属于某类)}{P(属于某特征)}$



###朴素贝叶斯

朴素贝叶斯法是基于贝叶斯定理与特征条件独立假设的分类方法:

$P(A,B,C,D|S)$

$=P(A|S)*P(B|S)*P(C|S)*P(D|S)$

$=P(D|S)*P(C|S)*P(B|S)*P(A|S)$

$=P(D, C, B, A|S)$

在对推荐系统的时候，把所有的词语都分开之后进行相应的预测，bags of words



### 三种模型

1. 多项式模型：重复出现的次数视为多次，统计与判断时，都关注重复次数
2. 伯努利模型：重复出现的次数视为一次，更加简化和方便，丢失词频
3. 混合模型：在计算概率的时，不考虑重复次数，但是在统计概率P的时候，考虑重复词语的次数。



### 平滑技术(加1平滑)

####拉普拉斯平滑（Laplace Smoothing）又被称为加1平滑

概念：当某个词语没有出现的则概率为0，需要对其加上一个特定的概率

1. 多项式：

   训练接：(a,b,c,a,a)

   ​		(a,b,b)

   ​		(b,c,c)

   ---

   测试集:(d,a,c)

   $P(a) = \frac{4+1}{11+4}$, $P(b) = \frac{4+1}{11+4}$, $P(c) = \frac{3+1}{11+4}$,$P(d) = \frac{1}{11+4}$

2. 伯努利:(需要完善)

   训练接：(a,b,c,a,a)

   ​		(a,b,b)

   ​		(b,c,c)

   ------

   测试集:(d,a,c)

   $P(a) = \frac{4+1}{11+4}$, $P(b) = \frac{4+1}{11+4}$, $P(c) = \frac{3+1}{11+4}$,$P(d) = \frac{1}{11+4}$

####古德图灵

​	增加未出现词语概率的同时，减少已出现词语的概率。

​	$ r^* = (r+1)\frac{E*N_{r+1}}{EN_r} $

####线性插值法

#### 退回法K-Z退回



***

###工程上的一些tricks

1. 取对数 

   判断事物为正面的时候

   $ logC = logP(A|S)+logP(B|S)…… logP(Z|S)$

2. 转换为权重

   $ logC 为事物的正面， log \overline C 为事物的方面 $

   ###$ \frac{logC}{log\overline C} = \frac{logP(A|S)}{logP(A|H)}+\frac{logP(B|S)}{logP(B|H)}… \frac{logP(Z|S)}{logP(Z|H)}$

   ​

3. 选取topk的关键词，需要依靠经验选定一个正数阀值

4. 分割样本(样本过大的时候，分开之后去topk值分析)

5. 位置权重

6. 蜜罐

7. 其他

---

### NB与LR的对比

naive bayes ：朴素贝叶斯

logistics regression：逻辑回归

区别：（需要完善）



---

### 贝叶斯网络

简单的贝叶斯网络：

$P(a,b,c)= P(c|a,b)P(b|a)P(a)$

a-->b-->c   a-->c



全连接贝叶斯网络

$P(X_1,X_2……P_k)=P(X_K|X_1*X_{k-1})……P(X_2|P(X_1)*P(X_1)$

$X_1-->X_2-->X_3-->X_{k_1}-->X_k$





特殊贝叶斯网络： 马尔科夫模型

$A_{j+1}只有A{j}有关，与其他的五官$

$ A_1-->A_2-->A_3-->A_j-->A{j+1}$



A:

​	tail-to-tail, 已知c的概率，然后推出a和b的概率

 	$ a<--c-->b $

​	$ P(a,b,c)=P(c)*P(a|c)*P(b|c) $

B:

​	head-to-tail，已知c的概率，然后推出a和b的概率

​	$ a-->c-->b $

​	$ P(a,b,c)=P(a)*P(c|a)*P(b|c) $	

C:

​	head-to-head,

​	$ a-->c<--b $	

​	$ P(a,b,c)=P(a)*P(b)*P(c|a,b) $